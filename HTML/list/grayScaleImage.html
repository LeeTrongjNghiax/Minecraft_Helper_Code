<script src="https://www.dukelearntoprogram.com/course1/common/js/image/SimpleImage.js" >
</script>

<img src="https://cdn.hashnode.com/res/hashnode/image/upload/v1600097347472/FaJTB7UrN.jpeg" id="eeveelutions" />
<canvas id="canvas" width="200" height="200"></canvas>

<script>

const img = document.getElementById("eeveelutions");
// const canvas = document.getElementById("canvas");
// const ctx = canvas.getContext("2d");

// img.onload = function () {
//   img.crossOrigin = "anonymous";
//   ctx.drawImage(img, 0, 0);
//   const imgData = ctx.getImageData(0, 0, canvas.width, canvas.height);
//   for (i = 0; i < imgData.data.length; i += 4) {
//     let count = imgData.data[i] + imgData.data[i + 1] + imgData.data[i + 2];
//     let colour = 0;
//     if (count > 383) colour = 255;

//     imgData.data[i] = colour;
//     imgData.data[i + 1] = colour;
//     imgData.data[i + 2] = colour;
//     imgData.data[i + 3] = 255;
//   }
//   ctx.putImageData(imgData, 0, 0);
// };

function gray(imgObj) {
    var canvas = document.createElement('canvas');
    var canvasContext = canvas.getContext('2d');
     
    var imgW = imgObj.width;
    var imgH = imgObj.height;
    canvas.width = imgW;
    canvas.height = imgH;
     
    canvasContext.drawImage(imgObj, 0, 0);
    var imgPixels = canvasContext.getImageData(0, 0, imgW, imgH);
     
    for(var y = 0; y < imgPixels.height; y++){
        for(var x = 0; x < imgPixels.width; x++){
            var i = (y * 4) * imgPixels.width + x * 4;
            var avg = (imgPixels.data[i] + imgPixels.data[i + 1] + imgPixels.data[i + 2]) / 3;
            imgPixels.data[i] = avg; 
            imgPixels.data[i + 1] = avg; 
            imgPixels.data[i + 2] = avg;
        }
    }
    canvasContext.putImageData(imgPixels, 0, 0, 0, 0, imgPixels.width, imgPixels.height);
    return canvas.toDataURL();
}
img.src = gray(img)

</script>